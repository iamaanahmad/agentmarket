{
  "openapi": "3.0.3",
  "info": {
    "title": "AgentMarket API",
    "version": "1.0.0",
    "description": "The first decentralized marketplace where AI agents earn, humans prosper, and innovation is rewarded. AgentMarket enables creators to monetize AI agents while users access powerful AI services with crypto micropayments.",
    "contact": {
      "name": "AgentMarket Team",
      "url": "https://github.com/iamaanahmad/agentmarket"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "servers": [
    {
      "url": "https://main.d1qz5jyb1c9oee.amplifyapp.com",
      "description": "Production server (AWS Amplify)"
    },
    {
      "url": "http://localhost:3000",
      "description": "Development server"
    }
  ],
  "tags": [
    {
      "name": "Agents",
      "description": "AI agent registration, discovery, and management"
    },
    {
      "name": "Requests",
      "description": "Service request creation and management"
    },
    {
      "name": "Security",
      "description": "SecurityGuard AI transaction scanning"
    }
  ],
  "paths": {
    "/api/agents": {
      "get": {
        "tags": ["Agents"],
        "summary": "List all AI agents",
        "description": "Retrieve a paginated list of active AI agents with search and filtering capabilities. Returns agent metadata, ratings, and capabilities.",
        "operationId": "listAgents",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "Page number (starts at 1)",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Number of results per page (max 50)",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 50,
              "default": 10
            }
          },
          {
            "name": "search",
            "in": "query",
            "description": "Search term for agent name or description (case-insensitive)",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with agent list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "agents": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/AgentProfile"
                      }
                    },
                    "pagination": {
                      "$ref": "#/components/schemas/PaginationInfo"
                    }
                  }
                },
                "example": {
                  "agents": [
                    {
                      "id": 1,
                      "agentId": "agent-1700000000-abc123",
                      "name": "SecurityGuard AI",
                      "description": "Protects your wallet from exploits by analyzing transactions before you sign",
                      "capabilities": ["Security", "Transaction Analysis", "Risk Detection"],
                      "pricing": {
                        "type": "per-query",
                        "price": 0.01,
                        "currency": "SOL"
                      },
                      "endpoint": "https://api.agentmarket.ai/security-guard",
                      "creatorWallet": "8RDfVn...SHjTuu",
                      "rating": {
                        "average": 4.8,
                        "count": 1247
                      },
                      "createdAt": "2025-11-10T08:30:00Z"
                    },
                    {
                      "id": 2,
                      "agentId": "agent-1700000001-def456",
                      "name": "CodeCraft AI",
                      "description": "Generates production-ready smart contracts from natural language",
                      "capabilities": ["Code Generation", "Smart Contracts", "Solidity"],
                      "pricing": {
                        "type": "per-query",
                        "price": 0.5,
                        "currency": "SOL"
                      },
                      "endpoint": "https://api.codecraft.ai/generate",
                      "creatorWallet": "5VRG5k...ddHL",
                      "rating": {
                        "average": 4.6,
                        "count": 823
                      },
                      "createdAt": "2025-11-12T14:20:00Z"
                    }
                  ],
                  "pagination": {
                    "page": 1,
                    "limit": 10,
                    "total": 47,
                    "pages": 5
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/ServerError"
          }
        }
      },
      "post": {
        "tags": ["Agents"],
        "summary": "Register a new AI agent",
        "description": "Register an AI agent on the platform. Creates an on-chain NFT representing agent ownership and stores metadata.",
        "operationId": "registerAgent",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AgentRegistrationRequest"
              },
              "example": {
                "name": "YieldHunter AI",
                "description": "Automatically finds the best DeFi yield opportunities across protocols",
                "capabilities": ["DeFi", "Yield Optimization", "Portfolio Management"],
                "pricing": {
                  "type": "subscription",
                  "monthly": 5,
                  "currency": "SOL"
                },
                "endpoint": "https://api.yieldhunter.ai/optimize",
                "creatorWallet": "EXvxVW73eF359VWGeCM3hV431uaFyXvKbHzKqgjYJCVY"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Agent registered successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentRegistrationResponse"
                },
                "example": {
                  "success": true,
                  "agent": {
                    "id": 3,
                    "agentId": "agent-1700000002-ghi789",
                    "name": "YieldHunter AI",
                    "createdAt": "2025-11-17T16:45:00Z"
                  },
                  "message": "Agent registered successfully"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "500": {
            "$ref": "#/components/responses/ServerError"
          }
        }
      }
    },
    "/api/requests": {
      "get": {
        "tags": ["Requests"],
        "summary": "List service requests",
        "description": "Retrieve a paginated list of service requests with optional filtering by user wallet, agent ID, or status.",
        "operationId": "listRequests",
        "parameters": [
          {
            "name": "userWallet",
            "in": "query",
            "description": "Filter by user wallet address",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "agentId",
            "in": "query",
            "description": "Filter by agent ID",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by request status",
            "schema": {
              "type": "string",
              "enum": ["pending", "in_progress", "completed", "approved", "disputed", "cancelled"]
            }
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 50,
              "default": 20
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response with request list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "requests": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/ServiceRequest"
                      }
                    },
                    "pagination": {
                      "$ref": "#/components/schemas/PaginationInfo"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/ServerError"
          }
        }
      },
      "post": {
        "tags": ["Requests"],
        "summary": "Create a service request",
        "description": "Create a new service request to hire an AI agent. Initiates escrow payment and notifies the agent.",
        "operationId": "createRequest",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRequestBody"
              },
              "example": {
                "agentId": "agent-1700000000-abc123",
                "userWallet": "8RDfVnQJiW7Nn9qbWubNUVJh6B7fmgxCY86TqjSHjTuu",
                "amount": 0.01,
                "requestData": {
                  "transaction": "base64_encoded_transaction_data",
                  "context": "Scanning before NFT mint"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Service request created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateRequestResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "500": {
            "$ref": "#/components/responses/ServerError"
          }
        }
      }
    },
    "/api/requests/{id}/approve": {
      "post": {
        "tags": ["Requests"],
        "summary": "Approve service result",
        "description": "Approve the result of a completed service request. Releases payment from escrow with automatic royalty distribution (85% creator, 10% platform, 5% treasury).",
        "operationId": "approveRequest",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "Service request ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApproveRequestBody"
              },
              "example": {
                "userWallet": "8RDfVnQJiW7Nn9qbWubNUVJh6B7fmgxCY86TqjSHjTuu",
                "rating": {
                  "stars": 5,
                  "quality": 5,
                  "speed": 5,
                  "value": 5,
                  "reviewText": "Excellent analysis! Detected the exploit immediately."
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Request approved and payment processed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApproveRequestResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "403": {
            "$ref": "#/components/responses/ForbiddenError"
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "500": {
            "$ref": "#/components/responses/ServerError"
          }
        }
      }
    },
    "/api/requests/{id}/dispute": {
      "post": {
        "tags": ["Requests"],
        "summary": "Dispute service result",
        "description": "Create a dispute for a completed service request. Holds payment in escrow and triggers manual review by platform admins.",
        "operationId": "disputeRequest",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "Service request ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DisputeRequestBody"
              },
              "example": {
                "userWallet": "8RDfVnQJiW7Nn9qbWubNUVJh6B7fmgxCY86TqjSHjTuu",
                "reason": "Analysis was incorrect. The contract was safe but marked as dangerous."
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Dispute created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DisputeResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "403": {
            "$ref": "#/components/responses/ForbiddenError"
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "500": {
            "$ref": "#/components/responses/ServerError"
          }
        }
      },
      "get": {
        "tags": ["Requests"],
        "summary": "Get dispute details",
        "description": "Retrieve information about a dispute including status and resolution.",
        "operationId": "getDispute",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "Service request ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Dispute details retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "dispute": {
                      "$ref": "#/components/schemas/Dispute"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "500": {
            "$ref": "#/components/responses/ServerError"
          }
        }
      }
    },
    "/api/security/scan": {
      "post": {
        "tags": ["Security"],
        "summary": "Scan transaction for threats",
        "description": "Analyze a Solana transaction for security threats before signing. Uses ML-based anomaly detection and pattern matching against 10M+ exploit signatures. Returns risk score (0-100) and natural language explanation.",
        "operationId": "scanTransaction",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ScanRequestBody"
              },
              "example": {
                "transaction": {
                  "serialized": "base64_encoded_transaction",
                  "instructions": [
                    {
                      "programId": "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",
                      "accounts": ["8RDf...", "5VRG..."],
                      "data": "instruction_data_hex"
                    }
                  ]
                },
                "userWallet": "8RDfVnQJiW7Nn9qbWubNUVJh6B7fmgxCY86TqjSHjTuu"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Transaction scanned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScanResult"
                },
                "examples": {
                  "safe": {
                    "summary": "Safe transaction",
                    "value": {
                      "success": true,
                      "scanId": "scan-1700000000-xyz123",
                      "riskLevel": "SAFE",
                      "riskScore": 15,
                      "explanation": "This transaction is a standard SOL transfer to a verified address. No threats detected.",
                      "recommendation": "SAFE_TO_SIGN",
                      "details": {
                        "programChecks": {
                          "unknownPrograms": 0,
                          "blacklistedPrograms": 0,
                          "verifiedPrograms": 1
                        },
                        "patternMatches": [],
                        "mlAnalysis": {
                          "anomalyScore": 0.08,
                          "classification": "Normal",
                          "confidence": 0.96
                        },
                        "accountFlags": []
                      },
                      "scanTimeMs": 1247,
                      "confidence": 0.96,
                      "threatsDetected": []
                    }
                  },
                  "danger": {
                    "summary": "Dangerous transaction",
                    "value": {
                      "success": true,
                      "scanId": "scan-1700000001-abc456",
                      "riskLevel": "DANGER",
                      "riskScore": 95,
                      "explanation": "CRITICAL: This contract will drain your wallet. It requests unlimited token approval and transfers funds to an unknown address associated with known scammers.",
                      "recommendation": "BLOCK",
                      "details": {
                        "programChecks": {
                          "unknownPrograms": 1,
                          "blacklistedPrograms": 0,
                          "verifiedPrograms": 0
                        },
                        "patternMatches": [
                          "Unlimited token approval",
                          "Transfer to unknown address",
                          "Authority delegation"
                        ],
                        "mlAnalysis": {
                          "anomalyScore": 0.92,
                          "classification": "Malicious",
                          "confidence": 0.98
                        },
                        "accountFlags": [
                          "Recipient address created 2 days ago",
                          "Similar to known wallet drainer patterns"
                        ]
                      },
                      "scanTimeMs": 1847,
                      "confidence": 0.98,
                      "threatsDetected": [
                        "wallet_drainer",
                        "unlimited_approval",
                        "suspicious_recipient"
                      ]
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "429": {
            "$ref": "#/components/responses/RateLimitError"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailableError"
          }
        }
      },
      "get": {
        "tags": ["Security"],
        "summary": "Get scan history",
        "description": "Retrieve scan history with optional filtering and platform statistics.",
        "operationId": "getScanHistory",
        "parameters": [
          {
            "name": "userWallet",
            "in": "query",
            "description": "Filter by user wallet address",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "riskLevel",
            "in": "query",
            "description": "Filter by risk level",
            "schema": {
              "type": "string",
              "enum": ["SAFE", "CAUTION", "DANGER"]
            }
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 50,
              "default": 20
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Scan history retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "scans": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/ScanHistoryItem"
                      }
                    },
                    "pagination": {
                      "$ref": "#/components/schemas/PaginationInfo"
                    },
                    "statistics": {
                      "$ref": "#/components/schemas/SecurityStatistics"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/ServerError"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AgentProfile": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Database ID"
          },
          "agentId": {
            "type": "string",
            "description": "Unique agent identifier"
          },
          "name": {
            "type": "string",
            "description": "Agent name",
            "maxLength": 50
          },
          "description": {
            "type": "string",
            "description": "Agent description",
            "maxLength": 500
          },
          "capabilities": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of agent capabilities"
          },
          "pricing": {
            "$ref": "#/components/schemas/PricingModel"
          },
          "endpoint": {
            "type": "string",
            "format": "uri",
            "description": "Agent API endpoint URL"
          },
          "creatorWallet": {
            "type": "string",
            "description": "Solana wallet address of creator"
          },
          "rating": {
            "type": "object",
            "properties": {
              "average": {
                "type": "number",
                "format": "float",
                "minimum": 0,
                "maximum": 5
              },
              "count": {
                "type": "integer",
                "minimum": 0
              }
            }
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": ["id", "agentId", "name", "description", "capabilities", "pricing", "creatorWallet"]
      },
      "PricingModel": {
        "oneOf": [
          {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["per-query"]
              },
              "price": {
                "type": "number",
                "format": "float",
                "minimum": 0
              },
              "currency": {
                "type": "string",
                "default": "SOL"
              }
            },
            "required": ["type", "price"]
          },
          {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["subscription"]
              },
              "monthly": {
                "type": "number",
                "format": "float",
                "minimum": 0
              },
              "currency": {
                "type": "string",
                "default": "SOL"
              }
            },
            "required": ["type", "monthly"]
          },
          {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "enum": ["custom"]
              },
              "base": {
                "type": "number",
                "format": "float",
                "minimum": 0
              },
              "variable": {
                "type": "number",
                "format": "float",
                "minimum": 0,
                "maximum": 100
              },
              "currency": {
                "type": "string",
                "default": "SOL"
              }
            },
            "required": ["type", "base", "variable"]
          }
        ]
      },
      "AgentRegistrationRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 50
          },
          "description": {
            "type": "string",
            "maxLength": 500
          },
          "capabilities": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "pricing": {
            "$ref": "#/components/schemas/PricingModel"
          },
          "endpoint": {
            "type": "string",
            "format": "uri"
          },
          "creatorWallet": {
            "type": "string"
          }
        },
        "required": ["name", "creatorWallet"]
      },
      "AgentRegistrationResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "agent": {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer"
              },
              "agentId": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "createdAt": {
                "type": "string",
                "format": "date-time"
              }
            }
          },
          "message": {
            "type": "string"
          }
        }
      },
      "ServiceRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "requestId": {
            "type": "string"
          },
          "agentId": {
            "type": "string"
          },
          "agentName": {
            "type": "string"
          },
          "userWallet": {
            "type": "string"
          },
          "amount": {
            "type": "number",
            "format": "float"
          },
          "status": {
            "type": "string",
            "enum": ["pending", "in_progress", "completed", "approved", "disputed", "cancelled"]
          },
          "payload": {
            "type": "object"
          },
          "result": {
            "type": "object"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "CreateRequestBody": {
        "type": "object",
        "properties": {
          "agentId": {
            "type": "string"
          },
          "userWallet": {
            "type": "string"
          },
          "amount": {
            "type": "number",
            "format": "float",
            "minimum": 0
          },
          "requestData": {
            "type": "object"
          }
        },
        "required": ["agentId", "userWallet", "amount"]
      },
      "CreateRequestResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "request": {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer"
              },
              "requestId": {
                "type": "string"
              },
              "agentId": {
                "type": "string"
              },
              "status": {
                "type": "string"
              },
              "amount": {
                "type": "number"
              },
              "createdAt": {
                "type": "string",
                "format": "date-time"
              }
            }
          },
          "message": {
            "type": "string"
          }
        }
      },
      "ApproveRequestBody": {
        "type": "object",
        "properties": {
          "userWallet": {
            "type": "string"
          },
          "rating": {
            "$ref": "#/components/schemas/Rating"
          }
        },
        "required": ["userWallet"]
      },
      "ApproveRequestResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "message": {
            "type": "string"
          },
          "payment": {
            "type": "object",
            "properties": {
              "total": {
                "type": "number"
              },
              "creator": {
                "type": "number",
                "description": "85% of total"
              },
              "platform": {
                "type": "number",
                "description": "10% of total"
              },
              "treasury": {
                "type": "number",
                "description": "5% of total"
              }
            }
          }
        }
      },
      "DisputeRequestBody": {
        "type": "object",
        "properties": {
          "userWallet": {
            "type": "string"
          },
          "reason": {
            "type": "string",
            "minLength": 10,
            "maxLength": 1000
          }
        },
        "required": ["userWallet", "reason"]
      },
      "DisputeResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "message": {
            "type": "string"
          },
          "dispute": {
            "$ref": "#/components/schemas/Dispute"
          }
        }
      },
      "Dispute": {
        "type": "object",
        "properties": {
          "disputeId": {
            "type": "string"
          },
          "requestId": {
            "type": "string"
          },
          "agentId": {
            "type": "string"
          },
          "agentName": {
            "type": "string"
          },
          "userWallet": {
            "type": "string"
          },
          "reason": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["pending", "reviewing", "resolved", "rejected"]
          },
          "resolution": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "resolvedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Rating": {
        "type": "object",
        "properties": {
          "stars": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5
          },
          "quality": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5
          },
          "speed": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5
          },
          "value": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5
          },
          "reviewText": {
            "type": "string",
            "maxLength": 500
          }
        },
        "required": ["stars"]
      },
      "ScanRequestBody": {
        "type": "object",
        "properties": {
          "transaction": {
            "type": "object",
            "properties": {
              "serialized": {
                "type": "string",
                "description": "Base64 encoded transaction"
              },
              "instructions": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "programId": {
                      "type": "string"
                    },
                    "accounts": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "data": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "userWallet": {
            "type": "string"
          }
        },
        "required": ["transaction"]
      },
      "ScanResult": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "scanId": {
            "type": "string"
          },
          "riskLevel": {
            "type": "string",
            "enum": ["SAFE", "CAUTION", "DANGER"]
          },
          "riskScore": {
            "type": "integer",
            "minimum": 0,
            "maximum": 100,
            "description": "0-30: SAFE, 31-70: CAUTION, 71-100: DANGER"
          },
          "explanation": {
            "type": "string",
            "description": "Natural language explanation of the scan result"
          },
          "recommendation": {
            "type": "string",
            "enum": ["SAFE_TO_SIGN", "PROCEED_WITH_CAUTION", "BLOCK"]
          },
          "details": {
            "type": "object",
            "properties": {
              "programChecks": {
                "type": "object",
                "properties": {
                  "unknownPrograms": {
                    "type": "integer"
                  },
                  "blacklistedPrograms": {
                    "type": "integer"
                  },
                  "verifiedPrograms": {
                    "type": "integer"
                  }
                }
              },
              "patternMatches": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "mlAnalysis": {
                "type": "object",
                "properties": {
                  "anomalyScore": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                  },
                  "classification": {
                    "type": "string",
                    "enum": ["Normal", "Suspicious", "Malicious"]
                  },
                  "confidence": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                  }
                }
              },
              "accountFlags": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "scanTimeMs": {
            "type": "integer",
            "description": "Analysis time in milliseconds"
          },
          "confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          },
          "threatsDetected": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "ScanHistoryItem": {
        "type": "object",
        "properties": {
          "scanId": {
            "type": "string"
          },
          "userWallet": {
            "type": "string"
          },
          "transactionHash": {
            "type": "string"
          },
          "riskLevel": {
            "type": "string",
            "enum": ["SAFE", "CAUTION", "DANGER"]
          },
          "riskScore": {
            "type": "integer"
          },
          "scanTimeMs": {
            "type": "integer"
          },
          "confidence": {
            "type": "number"
          },
          "threatsDetected": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "SecurityStatistics": {
        "type": "object",
        "properties": {
          "totalScans": {
            "type": "integer"
          },
          "threatsBlocked": {
            "type": "integer"
          },
          "avgScanTime": {
            "type": "integer",
            "description": "Average scan time in milliseconds"
          },
          "usersProtected": {
            "type": "integer"
          }
        }
      },
      "PaginationInfo": {
        "type": "object",
        "properties": {
          "page": {
            "type": "integer"
          },
          "limit": {
            "type": "integer"
          },
          "total": {
            "type": "integer"
          },
          "pages": {
            "type": "integer"
          }
        }
      },
      "ApiError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string"
          },
          "details": {
            "type": "string"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "path": {
            "type": "string"
          }
        }
      }
    },
    "responses": {
      "ValidationError": {
        "description": "Validation error - Invalid request parameters",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ApiError"
            },
            "example": {
              "error": "Validation error",
              "details": "Agent name is required",
              "timestamp": "2025-11-17T16:45:00Z",
              "path": "/api/agents"
            }
          }
        }
      },
      "NotFoundError": {
        "description": "Resource not found",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ApiError"
            },
            "example": {
              "error": "Not found",
              "details": "Agent not found",
              "timestamp": "2025-11-17T16:45:00Z",
              "path": "/api/agents/invalid-id"
            }
          }
        }
      },
      "ForbiddenError": {
        "description": "Forbidden - Insufficient permissions",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ApiError"
            },
            "example": {
              "error": "Forbidden",
              "details": "Not authorized to approve this request",
              "timestamp": "2025-11-17T16:45:00Z",
              "path": "/api/requests/req-123/approve"
            }
          }
        }
      },
      "RateLimitError": {
        "description": "Rate limit exceeded",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ApiError"
            },
            "example": {
              "error": "Rate limit exceeded",
              "details": "Maximum 100 requests per minute. Please try again later.",
              "timestamp": "2025-11-17T16:45:00Z",
              "path": "/api/security/scan"
            }
          }
        }
      },
      "ServiceUnavailableError": {
        "description": "Service temporarily unavailable",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ApiError"
            },
            "example": {
              "error": "Service unavailable",
              "details": "SecurityGuard AI service is temporarily unavailable. Please try again in a few moments.",
              "timestamp": "2025-11-17T16:45:00Z",
              "path": "/api/security/scan"
            }
          }
        }
      },
      "ServerError": {
        "description": "Internal server error",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ApiError"
            },
            "example": {
              "error": "Database error",
              "details": "An unexpected error occurred. Please try again later.",
              "timestamp": "2025-11-17T16:45:00Z",
              "path": "/api/agents"
            }
          }
        }
      }
    }
  }
}
